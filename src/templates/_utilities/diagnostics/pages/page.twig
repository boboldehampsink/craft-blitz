{% extends 'blitz/_utilities/diagnostics/layouts/page' %}

{% set page = craft.blitz.diagnostics.getPage() %}
{% if page is null %}
    {% redirect 'utilities/blitz-diagnostics/pages' with error 'The page no longer exists or may have been refreshed.' %}
{% endif %}
{% set elementTypes = craft.blitz.diagnostics.getElementTypes(siteId, page.id) %}
{% set elementQueryTypes = craft.blitz.diagnostics.getElementQueryTypes(siteId, page.id) %}
{% set isLeaf = true %}

{% block content %}

    <h1>
        {{ elementTypes|length ? 'Tracked Elements'|t('blitz') : 'No Tracked Elements'|t('blitz') }}
    </h1>

    {% if elementTypes|length %}
        <div class="elements">
            <table class="data fullwidth">
                <thead>
                    <tr>
                        <th>
                            {{ 'Element Type'|t('blitz') }}
                        </th>
                        <th>
                            {{ 'Elements'|t('blitz') }}
                        </th>
                    </tr>
                </thead>
                <tbody>
                    {% for elementType in elementTypes %}
                        <tr>
                            <td class="code">
                                <a href="{{ url('utilities/blitz-diagnostics/pages/element-type', {
                                    pageId: page.id,
                                    elementType: elementType.type
                                }) }}">
                                    {{ elementType.type }}
                                </a>
                            </td>
                            <td>
                                {{ elementType.count|number }}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <br>
    {% endif %}

    <h1>
        {{ elementQueryTypes|length ? 'Tracked Element Queries'|t('blitz') : 'No Tracked Element Queries'|t('blitz') }}
    </h1>

    {% if elementQueryTypes|length %}
        <div class="elements">
            <table class="data fullwidth">
                <thead>
                    <tr>
                        <th>
                            {{ 'Element Query Type'|t('blitz') }}
                        </th>
                        <th>
                            {{ 'Element Queries'|t('blitz') }}
                        </th>
                    </tr>
                </thead>
                <tbody>
                    {% for elementQueryType in elementQueryTypes %}
                        <tr>
                            <td class="code">
                                <a href="{{ url('utilities/blitz-diagnostics/pages/element-query-type', {
                                    pageId: page.id,
                                    elementType: elementQueryType.type
                                }) }}">
                                    {{ elementQueryType.type }}
                                </a>
                            </td>
                            <td>
                                {{ elementQueryType.count|number }}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% endif %}

{% endblock %}
